<?xml version="1.0" encoding="UTF-8"?>
<dynaForm type="xmlmenu">
<MNU_ADD type="link" value='' link="#" onclick="stepAdd(); return false;" colAlign="left" colWidth="35">
  <en>New</en>
</MNU_ADD>
<!--<PAGED_TABLE_FAST_SEARCH type="FastSearch" label="@G::LoadTranslation(ID_SEARCH)"/>-->
<PROCESS type="hidden" showInTable="0"/>
<TASK type="hidden" showInTable="0"/>
<CONFIRM type="hidden" showInTable="0"/>
<URL_STEPS_EDIT defaultValue="../steps/steps_New" type="private"/>
<URL_STEP_DELETE defaultValue="../steps/steps_Delete" type="private"/>
<URL_STEP_UP defaultValue="../steps/steps_Up" type="private"/>
<URL_STEP_DOWN defaultValue="../steps/steps_Down" type="private"/>
<PAGED_TABLE_ID type="private"/>
<js type="javascript" replaceTags="1">
  function stepAdd(){
		popupWindow('@G::LoadTranslation(ID_NEW_STEP)', '@G::encryptlink(@#URL_STEPS_EDIT)?PROCESS=@#PROCESS&amp;TASK=@#TASK', 500, 420);
  }

  function stepSave(sProcess, sTask, sType, sUID) {
    var oRPC = new leimnud.module.rpc.xmlhttp({
      url   : '../steps/steps_Save',
      async : false,
      method: 'POST',
      args  : 'sProcess=' + sProcess + '&amp;sTask=' + sTask + '&amp;sType=' + sType + '&amp;sUID=' + sUID
    });
    oRPC.make();
    currentPopupWindow.remove();
    @#PAGED_TABLE_ID.refresh();
  }
  function stepUp( uid, stepPos  ){
    result = ajax_function('@G::encryptlink(@#URL_STEP_UP)','','STEP_UID='+uid+'&amp;TASK=@#TASK&amp;STEP_POSITION='+stepPos,'POST');
    @#PAGED_TABLE_ID.refresh();
  }
  function stepDown( uid, stepPos  ){
    result = ajax_function('@G::encryptlink(@#URL_STEP_DOWN)','','STEP_UID='+uid+'&amp;TASK=@#TASK&amp;STEP_POSITION='+stepPos,'POST');
    @#PAGED_TABLE_ID.refresh();
  }
  function stepDelete( uid, stepPos  ){
    new leimnud.module.app.confirm().make({
      label:'@#CONFIRM',
      action:function()
      {
        ajax_function('@G::encryptlink(@#URL_STEP_DELETE)','','STEP_UID='+uid+'&amp;TASK=@#TASK&amp;STEP_POSITION='+stepPos,'POST');
        @#PAGED_TABLE_ID.refresh();
      }.extend(this)
    });
  }
  function devolver(result){
  //alert(result);
  };
</js>






<PRO_UID type="private" />
<dynaformsEdit type="private"  defaultValue="../dynaforms/dynaforms_Edit"/>
<dynaformsNewPlugin type="private" defaultValue="../dynaforms/dynaforms_NewPlugin"/>
<dynaformsEditor type="private" defaultValue="../dynaforms/dynaforms_Editor"/>
<dynaformsFlatEditor type="private" defaultValue="../dynaforms/dynaforms_FlatEditor"/>
<dynaformsDelete type="private" defaultValue="../dynaforms/dynaforms_Delete"/>

<js type="javascript" replaceTags="1"><![CDATA[
  function dynaformAdd(){
        popupWindow('@G::LoadTranslation(ID_NEW_DYNAFORM)', '@G::encryptlink(@#dynaformsNewPlugin)?PRO_UID=@%PRO_UID' , 500, 350);
        //popupWindow('@G::LoadTranslation(ID_NEW_DYNAFORM)', '@G::encryptlink(@#dynaformsEdit)?PRO_UID=@%PRO_UID' , 500, 350);
  }
  function dynaformPluginAdd(){
        popupWindow('@G::LoadTranslation(ID_NEW_DYNAFORM)', '@G::encryptlink(@#dynaformsEdit)?PRO_UID=@%PRO_UID' , 500, 350);
  }
  function dynaformProperties( uid ){
        popupWindow('@G::LoadTranslation(ID_EDIT_DYNAFORM)', '@G::encryptlink(@#dynaformsEdit)?DYN_UID='+ uid , 500, 400);
  }
  function dynaformEdit( uid ){
        window.location.href = "@G::encryptlink(@#dynaformsEditor)?PRO_UID=@%PRO_UID&DYN_UID="+uid;
  }
  function dynaformFlatEdit( uid ){
        var rr1;
    var divEditor=document.getElementById('DynaformsEditorDiv');
    if (!divEditor) divEditor=createDivEditor('DynaformsEditorDiv');
    divEditor.innerHTML=ajax_function("@G::encryptlink(@#dynaformsFlatEditor)","","DYN_UID="+uid+"&PRO_UID="+"@#PRO_UID");
        var myScripts = divEditor.getElementsByTagName('SCRIPT');
        var code=[];
        for(rr1=0; rr1<myScripts.length ; rr1++){
          code[rr1]=myScripts[rr1].innerHTML
        }
        for(rr1=0; rr1<code.length ; rr1++){
          try {
          if (window.execScript)
            window.execScript( code[rr1] ,'javascript');
        else
          window.setTimeout( code[rr1], 0 );
          } catch (e) {
            alert(e.description);
          }
        }
        delete code;
        delete divEditor;
        delete myScripts;
  }
  function createDivEditor(id) {

     var newdiv = document.createElement('div');
     newdiv.setAttribute('id', id);

     newdiv.style.position = "absolute";
     newdiv.style.left = 0;
     newdiv.style.top = 0;

     newdiv.style.visibility="hidden";

     document.body.appendChild(newdiv);

     return document.getElementById(id);
  }
  function dynaformSave ( form ) {
    ajax_post( form.action, form, 'POST' );
    currentPopupWindow.remove();
    @#PAGED_TABLE_ID.refresh();
  }
  function dynaformDelete ( uid ){
    new leimnud.module.app.confirm().make({
        label:'@G::LoadTranslation(ID_MSG_CONFIRM_DELETE_DYNAFORM)',
        action:function()
        {
        ajax_function('@G::encryptlink(@#dynaformsDelete)','','DYN_UID='+uid,'POST');
        @#PAGED_TABLE_ID.refresh();
      }.extend(this)
    });
  }
]]></js>


</dynaForm>
