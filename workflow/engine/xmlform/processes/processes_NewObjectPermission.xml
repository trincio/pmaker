<?xml version="1.0" encoding="UTF-8"?>
<dynaForm name="processes_NewObjectPermission" width="100%">
<TITLE type="title">
  <en>New Permission for Object</en>
</TITLE>
<LANG type="private" />
<PRO_UID type="hidden" />
<TAS_UID type="dropdown" mode="edit">
<![CDATA[SELECT TAS_UID, CON_VALUE AS TAS_TITLE FROM TASK LEFT JOIN CONTENT ON (TAS_UID = CON_ID AND CON_CATEGORY = 'TAS_TITLE' AND CON_LANG = @@LANG) WHERE PRO_UID = @@PRO_UID ORDER BY TAS_TITLE]]>
  <en>Task Target
  <option name="">Any</option>
  </en>
</TAS_UID>
<GROUP_USER type="dropdown" mode="edit" sqlConnection="dbarray">
SELECT * FROM usersGroups
  <en>Group or User</en>
</GROUP_USER>
<OP_TASK_SOURCE type="dropdown" mode="edit">
<![CDATA[SELECT TAS_UID, CON_VALUE AS TAS_TITLE FROM TASK LEFT JOIN CONTENT ON (TAS_UID = CON_ID AND CON_CATEGORY = 'TAS_TITLE' AND CON_LANG = @@LANG) WHERE PRO_UID = @@PRO_UID ORDER BY TAS_TITLE]]>
  <en>Task Source
  <option name="">Any</option>
  </en>
</OP_TASK_SOURCE>
<OP_PARTICIPATE type="yesno" defaultvalue="1" mode="edit">
  <en>Participated</en>
</OP_PARTICIPATE>
<OP_OBJ_TYPE type="dropdown" mode="edit" dependentfields="OP_OBJ_UID">
  <en>Type  <option name="ANY">Any</option>
    <option name="ANY_DYNAFORM">Any Dynaform</option>
    <option name="ANY_INPUT">Any Input Document</option>
    <option name="ANY_OUTPUT">Any Output Document</option>
    <option name="DYNAFORM">Dynaform</option>
    <option name="INPUT">Input Document</option>
    <option name="OUTPUT">Output Document</option>
  </en>
</OP_OBJ_TYPE>
<ALL type="dropdown" mode="edit" sqlConnection="dbarray">
<![CDATA[SELECT * FROM allObjects]]>
  <en>Object
    <option name="">All</option>
  </en>
</ALL>
<DYNAFORMS type="dropdown" mode="edit" sqlConnection="dbarray">
<![CDATA[SELECT * FROM allDynaforms]]>
  <en>DynaForm</en>
</DYNAFORMS>
<INPUTS type="dropdown" mode="edit" sqlConnection="dbarray">
<![CDATA[SELECT * FROM allInputs]]>
  <en>Input Document</en>
</INPUTS>
<OUTPUTS type="dropdown" mode="edit" sqlConnection="dbarray">
<![CDATA[SELECT * FROM allOutputs]]>
  <en>Output Document</en>
</OUTPUTS>
<OP_ACTION type="dropdown" mode="edit" >
  <en>Permission
    <option name="VIEW">View</option>
    <!--<option name="ADD">Add</option>
    <option name="EDIT">Edit</option>
    <option name="DELETE">Delete</option>
    <option name="REGENERATE">Regenerate</option>-->
    <option name="BLOCK">Block</option>
  </en>
</OP_ACTION>
<CREATE type="button" onclick="saveObjectPermission(this.form);">
  <en>Create</en>
</CREATE>
<JS type="javascript">
<![CDATA[
var aOptions = [];
var getOptions = function() {
  var oAux = getField('OP_ACTION');
  for (i = 0; i < oAux.options.length; i++) {
    aOptions.push({label:oAux.options[i].text, value: oAux.options[i].value});
  }
};
var rebuildOptions = function(sType) {
  /* for now nothing */
};
leimnud.event.add(getField('OP_OBJ_TYPE'), 'change', function() {
  var vValue = getField('OP_OBJ_TYPE').value;
  switch (vValue) {
    case 'ANY':
    case 'ANY_DYNAFORM':
    case 'ANY_INPUT':
    case 'ANY_OUTPUT':
      getField('ALL').value = '';
      getField('DYNAFORMS').value = '';
      getField('INPUTS').value = '';
      getField('OUTPUTS').value = '';
      hideRowById('ALL');
      hideRowById('DYNAFORMS');
      hideRowById('INPUTS');
      hideRowById('OUTPUTS');
    break;
    case 'DYNAFORM':
      getField('ALL').value = '';
      getField('DYNAFORMS').value = (getField('DYNAFORMS').options[0] ? getField('DYNAFORMS').options[0].value : '');
      getField('INPUTS').value = '';
      getField('OUTPUTS').value = '';
      hideRowById('ALL');
      showRowById('DYNAFORMS');
      hideRowById('INPUTS');
      hideRowById('OUTPUTS');
    break;
    case 'INPUT':
      getField('ALL').value = '';
      getField('DYNAFORMS').value = '';
      getField('INPUTS').value = (getField('INPUTS').options[0] ? getField('INPUTS').options[0].value : '');
      getField('OUTPUTS').value = '';
      hideRowById('ALL');
      hideRowById('DYNAFORMS');
      showRowById('INPUTS');
      hideRowById('OUTPUTS');
    break;
    case 'OUTPUT':
      getField('ALL').value = '';
      getField('DYNAFORMS').value = '';
      getField('INPUTS').value = '';
      getField('OUTPUTS').value = (getField('OUTPUTS').options[0] ? getField('OUTPUTS').options[0].value : '');
      hideRowById('ALL');
      hideRowById('DYNAFORMS');
      hideRowById('INPUTS');
      showRowById('OUTPUTS');
    break;
  }
  rebuildOptions(vValue);
});
var vValue = getField('OP_OBJ_TYPE').value;
switch (vValue) {
  case 'ANY':
  case 'ANY_DYNAFORM':
  case 'ANY_INPUT':
  case 'ANY_OUTPUT':
    getField('ALL').value = '';
    getField('DYNAFORMS').value = '';
    getField('INPUTS').value = '';
    getField('OUTPUTS').value = '';
    hideRowById('ALL');
    hideRowById('DYNAFORMS');
    hideRowById('INPUTS');
    hideRowById('OUTPUTS');
  break;
  case 'DYNAFORM':
    getField('ALL').value = '';
    getField('DYNAFORMS').value = (getField('DYNAFORMS').options[0] ? getField('DYNAFORMS').options[0].value : '');
    getField('INPUTS').value = '';
    getField('OUTPUTS').value = '';
    hideRowById('ALL');
    showRowById('DYNAFORMS');
    hideRowById('INPUTS');
    hideRowById('OUTPUTS');
  break;
  case 'INPUT':
    getField('ALL').value = '';
    getField('DYNAFORMS').value = '';
    getField('INPUTS').value = (getField('INPUTS').options[0] ? getField('INPUTS').options[0].value : '');
    getField('OUTPUTS').value = '';
    hideRowById('ALL');
    hideRowById('DYNAFORMS');
    hideRowById('INPUTS');
    showRowById('OUTPUTS');
  break;
  case 'OUTPUT':
    getField('ALL').value = '';
    getField('DYNAFORMS').value = '';
    getField('INPUTS').value = '';
    getField('OUTPUTS').value = (getField('OUTPUTS').options[0] ? getField('OUTPUTS').options[0].value : '');
    hideRowById('ALL');
    hideRowById('DYNAFORMS');
    hideRowById('INPUTS');
    showRowById('OUTPUTS');
  break;
}
getOptions();
rebuildOptions(vValue);
]]>
</JS>
</dynaForm>